version: 2.1
orbs:
  ruby-rails: sul-dlss/ruby-rails@3.2.0
# NOTE: Jan 2022 TravisCI had this package installed, but tests pass in CircleCI without explicitly adding:
#    - libimage-exiftool-perl
workflows:
  build:
    jobs:
      - ruby-rails/lint:
          name: lint
      - ruby-rails/test-rails:
          name: test
          api-only: true # note: this leaves off checking the yarn.lock file, which pre-assembly doesn't have
          executor:
            name: ruby-rails/ruby-postgres
            ruby-tag: '3.0.3'
          before-test:
            - run:
                name: Install exiftool
                command: curl -L http://cpanmin.us | perl - --sudo Image::ExifTool
