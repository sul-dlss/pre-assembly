
<div data-controller="globus <%= "ocr" if Settings.ocr.enabled%>">

<div class="row">
    <div class="col">
        <h3>Complete the form below</h3>
    </div>
    <div class="col" style="text-align: right;">
      <% if Settings.globus.enabled %>
        <button class="btn btn-sul-dlss" data-globus-target="requestGlobusLink" data-action="click->globus#createDestination">Request Globus Link</button>
      <% end %>
    </div>
</div>

<%= simple_form_for @batch_context do |form| %>
    <%= form.input :project_name %>

    <%= form.simple_fields_for :job_runs do |jt| %>
        <%= jt.input :job_type, collection:
            [
                ["Pre Assembly Run", "preassembly"],
                ["Discovery Report", "discovery_report"]
            ]
        %>
    <% end %>

    <% if Settings.ocr.enabled # if OCR is enabled, the content_structure drop down menu will hide/show ocr menus via stimulus %>
        <%= form.input :content_structure, input_html: { data: { action: "change->ocr#changed", "ocr-target": "contentStructure" } }, collection: content_structure %>

        <div id="ocr-settings-image" data-ocr-target="ocrSettingsImage" hidden>
            <%= form.input :manually_corrected_ocr,
                as: :radio_buttons,
                input_html: { data: { "ocr-target": "manuallyCorrectedOcrImage" } },
                label: 'Do the image(s) have pre-existing OCR that has been manually reviewed/corrected for accessibility?',
                collection: [['Yes', true], ['No', false]] %>
            <%= form.input :run_ocr,
                as: :radio_buttons,
                input_html: { data: { "ocr-target": "runOcrImage" } },
                label: 'Would you like to run SDR/ABBYY OCR on your image(s)?',
                collection: [['Yes. Run ABBYY OCR.', true], ['No. Do not run ABBYY OCR.', false]] %>
        </div>

        <div id="ocr-settings-document" data-ocr-target="ocrSettingsDocument" hidden>
            <%= form.input :manually_corrected_ocr,
                as: :radio_buttons,
                input_html: { data: { "ocr-target": "manuallyCorrectedOcrDocument" } },
                label: 'Have you manually reviewed/corrected your document(s) for WCAG/PDFUA compliance?',
                collection: [['Yes. Document(s) meet a11y requirements. You donâ€™t need to run SDR/ABBYY OCR.', true], ["No/Don't Know. We recommend that you manually review/correct the document in an editor, and then return to Preassembly.", false]] %>
            <%= form.input :run_ocr,
                as: :radio_buttons,
                input_html: { data: { "ocr-target": "runOcrDocument" } },
                label: 'Would you like to run SDR/ABBYY OCR on your image(s)?',
                collection: [['Yes. Run ABBYY OCR. Warning: If your document is already WCAG/PDFUA compliant,  ABBYY may create a less accessible version.', true], ['No. Do not run ABBYY OCR.', false]] %>
        </div>
    <% else # if OCR is not enabled, use the regular drop down menu %>
       <%= form.input :content_structure, collection: content_structure %>
    <% end %>

    <%= form.input :staging_location, input_html: { data: { "globus-target": "stagingLocation" } } %>

    <%# the 'staging_style_symlink` is hidden, since we do not currently want users to access it (it may cause problems with some accessioning steps)%>
    <%= form.hidden_field :staging_style_symlink, value: false %>
    <%= form.input :processing_configuration, collection:
        [
            ["Default", "default"],
            ["Group by filename", "filename"],
            ["Group by filename (with pre-existing OCR)", "filename_with_ocr"]
        ]
    %>

    <%= form.input :using_file_manifest, as: :boolean, label: 'I have a file manifest'%>

    <%= form.input :all_files_public,
                   as: :radio_buttons,
                   collection: [['Default', false], ['Preserve=Yes, Shelve=Yes, Publish=Yes', true]] %>

    <%= form.button :submit, class: "btn-sul-dlss" %>
<% end %>

</div>
